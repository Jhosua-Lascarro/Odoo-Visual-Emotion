name: CI Validation

on:
  pull_request:
    branches:
      - main
      - develop

jobs:
  lint-yaml:
    name: Lint YAML Files
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Run yamllint
        uses: ibiqlik/action-yamllint@v3
        with:
          file_or_dir: .
          config_data: |
            extends: default
            rules:
              line-length:
                max: 120
              comments:
                min-spaces-from-content: 1

  validate-docker:
    name: Validate Docker Compose
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Validate docker-compose syntax
        run: docker compose config --quiet

  validate-nginx:
    name: Validate Nginx Config
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Test nginx configuration
        run: |
          docker run --rm -v $(pwd)/config/nginx.conf:/etc/nginx/conf.d/default.conf:ro nginx:alpine nginx -t

