---
name: Sync Develop with Main

"on":
  push:
    branches:
      - main

permissions:
  contents: write

jobs:
  sync-branches:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Set up Git
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"

      - name: Merge main into develop
        run: |
          # Check if develop branch exists remotely
          if git ls-remote --exit-code --heads origin develop > /dev/null 2>&1; then
            echo "Develop branch exists, merging main into it..."
            git checkout develop
            git pull origin develop
            git merge origin/main --no-ff -m "chore: sync develop with main [skip ci]"
            git push origin develop
          else
            echo "Develop branch does not exist, creating it from main..."
            git checkout -b develop
            git push -u origin develop
          fi
